{"version":3,"sources":["components/PostsList/PostsList.tsx","api/api.ts","api/comments.ts","components/NewCommentForm/NewCommentForm.tsx","components/PostDetails/PostDetails.tsx","api/posts.ts","App.tsx","api/users.ts","index.tsx"],"names":["PostsList","postsList","onPostSelect","selectedPost","className","map","post","userId","title","type","onClick","id","BASE_URL","getPostComments","postId","fetch","then","response","json","removeComment","commentId","url","method","addComment","comment","data","headers","body","JSON","stringify","NewCommentForm","fetchComments","useState","userName","setUserName","userEmail","setUserEmail","commentBody","setComment","isNameValid","isEmailValid","isCommentValid","validation","setValidation","postComment","a","name","email","validateForm","emailRegex","length","test","prev","clearAllFields","useCallback","onFormSubmit","e","preventDefault","required","value","onChange","target","placeholder","PostDetails","postComments","setPostComments","shouldShowComments","setShouldShowComments","deleteComment","fetchPostComments","useEffect","error","Error","getAllPosts","App","setPostsList","users","setUsers","visiblePosts","setVisiblePosts","selectedPostId","setSelectedPostId","setSelectedPost","fetchPosts","fetchUsers","find","fetchUser","user","ReactDOM","render","document","getElementById"],"mappings":"iVAIaA,EAAqC,SAAC,GAE5C,IADLC,EACI,EADJA,UAAWC,EACP,EADOA,aAAcC,EACrB,EADqBA,aAEzB,OACE,sBAAKC,UAAU,YAAf,UACE,wCAEA,oBAAIA,UAAU,kBAAd,SACGH,EAAUI,KAAI,SAAAC,GAAI,OACjB,qBAAIF,UAAU,kBAAd,UACE,gCACE,8CACYE,EAAKC,QADjB,IAGG,OAEFD,EAAKE,SAER,wBACEC,KAAK,SACLL,UAAU,2BACVM,QAAS,kBAAMR,EAAaI,EAAKK,KAHnC,SAKGR,IAAiBG,EAAO,QAAU,WAdFA,EAAKK,aCXvCC,EAAW,oCAOjB,ICNMC,EAAkB,SAACC,GAC9B,OAAOC,MAAM,GAAD,OAAIH,EAAJ,4BAAgCE,IACzCE,MAAK,SAAAC,GAAQ,OAAIA,EAASC,WAGlBC,EAAgB,SAC3BC,GAEA,ODPqBC,ECOP,aAAD,OAAcD,GDNpBL,MAAMH,EAAWS,EAAK,CAAEC,OAAQ,WACpCN,MAAK,SAAAC,GAAQ,OAAIA,EAASC,UAFxB,IAAgBG,GCUVE,EAAa,SACxBC,GAEA,ODR+BC,ECQPD,EDPjBT,MAAMH,ECOF,YDPkB,CAC3BU,OAAQ,OACRI,QAAS,CACP,eAAgB,mCAElBC,KAAMC,KAAKC,UAAUJ,KAEpBT,MAAK,SAAAC,GAAQ,OAAIA,EAASC,UARZ,IAAcO,G,OEEpBK,G,MAAgD,SAAC,GAEvD,IADLhB,EACI,EADJA,OAAQiB,EACJ,EADIA,cAER,EAAgCC,mBAAS,IAAzC,mBAAOC,EAAP,KAAiBC,EAAjB,KACA,EAAkCF,mBAAS,IAA3C,mBAAOG,EAAP,KAAkBC,EAAlB,KACA,EAAkCJ,mBAAS,IAA3C,mBAAOK,EAAP,KAAoBC,EAApB,KACA,EAAoCN,mBAAqB,CACvDO,YAAa,KACbC,aAAc,KACdC,eAAgB,OAHlB,mBAAOC,EAAP,KAAmBC,EAAnB,KAMMC,EAAW,uCAAG,sBAAAC,EAAA,sEACZtB,EAAW,CACfuB,KAAMb,EACNc,MAAOZ,EACPR,KAAMU,EACNvB,SACAH,GAAI,IANY,2CAAH,qDAUXqC,EAAe,WAEnB,IAAMC,EAAa,2DAInB,SAHoBhB,EAASiB,QAAUb,EAAYa,QAChDD,EAAWE,KAAKhB,MAMdF,EAASiB,OAGZP,GAAc,SAACS,GAAD,mBAAC,eAAeA,GAAhB,IAAsBb,aAAa,OAFjDI,GAAc,SAACS,GAAD,mBAAC,eAAeA,GAAhB,IAAsBb,aAAa,OAK9CU,EAAWE,KAAKhB,GAGnBQ,GAAc,SAACS,GAAD,mBAAC,eAAeA,GAAhB,IAAsBZ,cAAc,OAFlDG,GAAc,SAACS,GAAD,mBAAC,eAAeA,GAAhB,IAAsBZ,cAAc,OAK/CH,EAAYa,OAGfP,GAAc,SAACS,GAAD,mBAAC,eAAeA,GAAhB,IAAsBX,gBAAgB,OAFpDE,GAAc,SAACS,GAAD,mBAAC,eAAeA,GAAhB,IAAsBX,gBAAgB,QAK/C,IAGHY,EAAiBC,uBAAY,WACjCpB,EAAY,IACZE,EAAa,IACbE,EAAW,IACXK,EAAc,CACZJ,YAAa,KACbC,aAAc,KACdC,eAAgB,SAEjB,IAEGc,EAAY,uCAAG,WACnBC,GADmB,SAAAX,EAAA,yDAGnBW,EAAEC,kBAEET,IALe,gCAMXJ,IANW,OAOjBb,IACAsB,IARiB,2CAAH,sDAYlB,OACE,uBAAMjD,UAAU,iBAAhB,UACE,qBAAKA,UAAU,aAAf,SACE,uBACEK,KAAK,OACLqC,KAAK,OACLY,UAAQ,EACRC,MAAO1B,EACP2B,SAAU,gBAAGC,EAAH,EAAGA,OAAH,OAAgB3B,EAAY2B,EAAOF,QAC7CG,YAAY,YACZ1D,UAAU,4BAId,qBAAKA,UAAU,aAAf,SACE,uBACEK,KAAK,QACLqC,KAAK,QACLY,UAAQ,EACRC,MAAOxB,EACPyB,SAAU,gBAAGC,EAAH,EAAGA,OAAH,OAAgBzB,EAAayB,EAAOF,QAC9CG,YAAY,aACZ1D,UAAU,4BAId,qBAAKA,UAAU,aAAf,SACE,0BACE0C,KAAK,OACLa,MAAOtB,EACPqB,UAAQ,EACRE,SAAU,gBAAGC,EAAH,EAAGA,OAAH,OAAgBvB,EAAWuB,EAAOF,QAC5CG,YAAY,oBACZ1D,UAAU,4BAId,wBACEK,KAAK,SACLL,UAAU,uCACVM,QAAS,SAAC8C,GAAD,OAAOD,EAAaC,IAH/B,2BAOA,sBAAKpD,UAAU,SAAf,WACiC,IAA9BsC,EAAWD,gBACV,mBAAGrC,UAAU,cAAb,sDAI2B,IAA5BsC,EAAWF,cACV,mBAAGpC,UAAU,cAAb,uDAI0B,IAA3BsC,EAAWH,aACV,mBAAGnC,UAAU,cAAb,uECzIG2D,G,MAA0C,SAAC,GAAc,IAAZzD,EAAW,EAAXA,KACxD,EAAwC0B,qBAAxC,mBAAOgC,EAAP,KAAqBC,EAArB,KACA,EAAoDjC,oBAAS,GAA7D,mBAAOkC,EAAP,KAA2BC,EAA3B,KAEMC,EAAa,uCAAG,WAAOhD,GAAP,SAAAyB,EAAA,sEACd1B,EAAcC,GADA,WAEhBd,EAFgB,4BAGlB2D,EAHkB,SAGIpD,EAAgBP,EAAKK,IAHzB,6EAAH,sDAOb0D,EAAiB,uCAAG,sBAAAxB,EAAA,gEACnBvC,QADmB,IACnBA,KAAMK,GADa,6DAKxBsD,EALwB,SAKFpD,EAAgBP,EAAKK,IALnB,6EAAH,qDAgBvB,OARA2D,qBAAU,WACR,IACED,IACA,MAAOE,GACP,MAAM,IAAIC,SAEX,CAAClE,IAGF,sBAAKF,UAAU,cAAf,UACE,+CAEA,yBAASA,UAAU,oBAAnB,SACE,mCAAIE,QAAJ,IAAIA,OAAJ,EAAIA,EAAME,UAGZ,0BACEJ,UAAU,wBACV,UAAQ,cAFV,UAIe,OAAZ4D,QAAY,IAAZA,KAAcd,OACb,yBACEzC,KAAK,SACLL,UAAU,SACVM,QAAS,WACPyD,GAAuBD,IAJ3B,UAOGA,EAAqB,OAAS,OAC9B,IARH,OASGF,QATH,IASGA,OATH,EASGA,EAAcd,OACd,IAVH,cAcA,kDAGF,oBAAI9C,UAAU,oBAAd,SACG8D,IAAkB,OACjBF,QADiB,IACjBA,OADiB,EACjBA,EAAc3D,KAAI,SAAAmB,GAAO,OACvB,qBAAIpB,UAAU,yBAAd,UACE,wBACEK,KAAK,SACLL,UAAU,oCACVM,QAAS,kBAAM0D,EAAc5C,EAAQb,KAHvC,eAOA,4BAAIa,EAAQG,SAR8BH,EAAQb,aAe5D,kCACE,qBAAKP,UAAU,4BAAf,SACE,cAAC,EAAD,CACEU,QAAY,OAAJR,QAAI,IAAJA,OAAA,EAAAA,EAAMK,KAAM,KACpBoB,cAAesC,aCnFdI,EAAc,WACzB,OAAO1D,MAAM,GAAD,OAAIH,EAAJ,WACTI,MAAK,SAAAC,GAAQ,OAAIA,EAASC,WCyFhBwD,EApFO,WACpB,MAAkC1C,mBAAiB,IAAnD,mBAAO/B,EAAP,KAAkB0E,EAAlB,KACA,EAA0B3C,mBAAiB,IAA3C,mBAAO4C,EAAP,KAAcC,EAAd,KACA,EAAwC7C,mBAAiB,IAAzD,mBAAO8C,EAAP,KAAqBC,EAArB,KACA,EAA4C/C,mBAAS,GAArD,mBAAOgD,EAAP,KAAuBC,EAAvB,KACA,EAAwCjD,qBAAxC,mBAAO7B,EAAP,KAAqB+E,EAArB,KAEAZ,qBAAU,WACR,IAAMa,EAAU,uCAAG,sBAAAtC,EAAA,kEACjB8B,EADiB,SACEF,IADF,8CAEjBM,EAFiB,SAEKN,IAFL,8EAAH,qDAKVW,EAAU,uCAAG,sBAAAvC,EAAA,kEACjBgC,EADiB,SCnBd9D,MAAM,GAAD,OAAIH,EAAJ,WACTI,MAAK,SAAAC,GAAQ,OAAIA,EAASC,UDkBR,6EAAH,qDAIhB,IACEiE,IACAC,IACA,MAAOb,GACP,MAAM,IAAIC,SAEX,IAEHF,qBAAU,WACRY,EAAgBJ,EACbO,MAAK,SAAA/E,GAAI,OAAIA,EAAKK,KAAOqE,QAC3B,CAACA,IAEJ,IAQMM,EAAS,uCAAG,WAAO3E,GAAP,SAAAkC,EAAA,yDACL,IAAPlC,EADY,uBAEdoE,EAAgB9E,GAFF,sCAOhB8E,EAPgB,SDxCSxE,EC+CUI,ED9C9BI,MAAM,GAAD,OAAIH,EAAJ,yBAA6BL,IACtCS,MAAK,SAAAC,GAAQ,OAAIA,EAASC,UCsCX,mEDxCQ,IAACX,ICwCT,OAAH,sDAUf,OACE,sBAAKH,UAAU,MAAf,UACE,wBAAQA,UAAU,cAAlB,SACE,wDAGE,yBACEA,UAAU,qBACVwD,SAAU,gBAAGC,EAAH,EAAGA,OAAH,OAAgByB,GAAWzB,EAAOF,QAF9C,UAIE,wBAAQA,MAAM,IAAd,uBACCiB,EAAMvE,KAAI,SAAAkF,GAAI,OACb,wBAAQ5B,MAAO4B,EAAK5E,GAApB,SAAyB4E,EAAKzC,kBAMtC,uBAAM1C,UAAU,YAAhB,UACE,qBAAKA,UAAU,eAAf,SACE,cAAC,EAAD,CACEH,UAAW6E,EACX5E,aAxCW,SAACY,GAElBmE,EADEnE,IAAWkE,EACKlE,EAEA,IAqCZX,aAAcA,MAGjBA,GACC,qBAAKC,UAAU,eAAf,SACE,cAAC,EAAD,CAAaE,KAAMH,GAAgB,gBEjF/CqF,IAASC,OACP,cAAC,EAAD,IACAC,SAASC,eAAe,W","file":"static/js/main.23198228.chunk.js","sourcesContent":["import React from 'react';\nimport { PostListProps } from '../../types';\nimport './PostsList.scss';\n\nexport const PostsList: React.FC<PostListProps> = ({\n  postsList, onPostSelect, selectedPost,\n}) => {\n  return (\n    <div className=\"PostsList\">\n      <h2>Posts:</h2>\n\n      <ul className=\"PostsList__list\">\n        {postsList.map(post => (\n          <li className=\"PostsList__item\" key={post.id}>\n            <div>\n              <b>\n                {`User #${post.userId}`}\n                :\n                {' '}\n              </b>\n              {post.title}\n            </div>\n            <button\n              type=\"button\"\n              className=\"PostsList__button button\"\n              onClick={() => onPostSelect(post.id)}\n            >\n              {selectedPost === post ? 'Close' : 'Open'}\n            </button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n","import { Comment } from '../types';\n\nexport const BASE_URL = 'https://mate.academy/students-api';\n\nexport function remove(url: string) {\n  return fetch(BASE_URL + url, { method: 'DELETE' })\n    .then(response => response.json());\n}\n\nexport const add = (url: string, data: Comment) => {\n  return fetch(BASE_URL + url, {\n    method: 'POST',\n    headers: {\n      'Content-type': 'application/json; charset=UTF-8',\n    },\n    body: JSON.stringify(data),\n  })\n    .then(response => response.json());\n};\n","import { BASE_URL, remove, add } from './api';\nimport { Comment } from '../types';\n\nexport const getPostComments = (postId: number) => {\n  return fetch(`${BASE_URL}/comments?postId=${postId}`)\n    .then(response => response.json());\n};\n\nexport const removeComment = (\n  commentId: number | undefined,\n) => {\n  return remove(`/comments/${commentId}`);\n};\n\nexport const addComment = (\n  comment: Comment,\n) => {\n  return add('/comments', comment);\n};\n","import React, { useCallback, useState } from 'react';\nimport { addComment } from '../../api/comments';\nimport { NewCommentFormProps } from '../../types';\nimport './NewCommentForm.scss';\n\ntype Validation = {\n  isNameValid: null | boolean,\n  isEmailValid: null | boolean,\n  isCommentValid: null | boolean,\n};\n\nexport const NewCommentForm: React.FC<NewCommentFormProps> = ({\n  postId, fetchComments,\n}) => {\n  const [userName, setUserName] = useState('');\n  const [userEmail, setUserEmail] = useState('');\n  const [commentBody, setComment] = useState('');\n  const [validation, setValidation] = useState<Validation>({\n    isNameValid: null,\n    isEmailValid: null,\n    isCommentValid: null,\n  });\n\n  const postComment = async () => {\n    await addComment({\n      name: userName,\n      email: userEmail,\n      body: commentBody,\n      postId,\n      id: 0,\n    });\n  };\n\n  const validateForm = () => {\n    // eslint-disable-next-line max-len\n    const emailRegex = /^([a-zA-Z0-9_\\-.]+)@([a-zA-Z0-9_\\-.]+)\\.([a-zA-Z]{2,5})$/;\n    const formIsValid = userName.length && commentBody.length\n    && emailRegex.test(userEmail);\n\n    if (formIsValid) {\n      return true;\n    }\n\n    if (!userName.length) {\n      setValidation((prev) => ({ ...prev, isNameValid: false }));\n    } else {\n      setValidation((prev) => ({ ...prev, isNameValid: true }));\n    }\n\n    if (!emailRegex.test(userEmail)) {\n      setValidation((prev) => ({ ...prev, isEmailValid: false }));\n    } else {\n      setValidation((prev) => ({ ...prev, isEmailValid: true }));\n    }\n\n    if (!commentBody.length) {\n      setValidation((prev) => ({ ...prev, isCommentValid: false }));\n    } else {\n      setValidation((prev) => ({ ...prev, isCommentValid: true }));\n    }\n\n    return false;\n  };\n\n  const clearAllFields = useCallback(() => {\n    setUserName('');\n    setUserEmail('');\n    setComment('');\n    setValidation({\n      isNameValid: null,\n      isEmailValid: null,\n      isCommentValid: null,\n    });\n  }, []);\n\n  const onFormSubmit = async (\n    e: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n  ) => {\n    e.preventDefault();\n\n    if (validateForm()) {\n      await postComment();\n      fetchComments();\n      clearAllFields();\n    }\n  };\n\n  return (\n    <form className=\"NewCommentForm\">\n      <div className=\"form-field\">\n        <input\n          type=\"text\"\n          name=\"name\"\n          required\n          value={userName}\n          onChange={({ target }) => setUserName(target.value)}\n          placeholder=\"Your name\"\n          className=\"NewCommentForm__input\"\n        />\n      </div>\n\n      <div className=\"form-field\">\n        <input\n          type=\"email\"\n          name=\"email\"\n          required\n          value={userEmail}\n          onChange={({ target }) => setUserEmail(target.value)}\n          placeholder=\"Your email\"\n          className=\"NewCommentForm__input\"\n        />\n      </div>\n\n      <div className=\"form-field\">\n        <textarea\n          name=\"body\"\n          value={commentBody}\n          required\n          onChange={({ target }) => setComment(target.value)}\n          placeholder=\"Type comment here\"\n          className=\"NewCommentForm__input\"\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        className=\"NewCommentForm__submit-button button\"\n        onClick={(e) => onFormSubmit(e)}\n      >\n        Add a comment\n      </button>\n      <div className=\"errors\">\n        {validation.isCommentValid === false && (\n          <p className=\"input-error\">\n            &#8226; Your comment should not be empty\n          </p>\n        )}\n        {validation.isEmailValid === false && (\n          <p className=\"input-error\">\n            &#8226;  Please enter valid email address\n          </p>\n        )}\n        {validation.isNameValid === false && (\n          <p className=\"input-error\">\n            &#8226; Field &#8220;name&#8221; should not be empty\n          </p>\n        )}\n      </div>\n    </form>\n  );\n};\n","import React, { useState, useEffect } from 'react';\nimport { getPostComments, removeComment } from '../../api/comments';\nimport { PostDetailsProps, Comment } from '../../types';\nimport { NewCommentForm } from '../NewCommentForm';\nimport './PostDetails.scss';\n\nexport const PostDetails: React.FC<PostDetailsProps> = ({ post }) => {\n  const [postComments, setPostComments] = useState<Comment[]>();\n  const [shouldShowComments, setShouldShowComments] = useState(true);\n\n  const deleteComment = async (commentId: number) => {\n    await removeComment(commentId);\n    if (post) {\n      setPostComments(await getPostComments(post.id));\n    }\n  };\n\n  const fetchPostComments = async () => {\n    if (!post?.id) {\n      return;\n    }\n\n    setPostComments(await getPostComments(post.id));\n  };\n\n  useEffect(() => {\n    try {\n      fetchPostComments();\n    } catch (error) {\n      throw new Error();\n    }\n  }, [post]);\n\n  return (\n    <div className=\"PostDetails\">\n      <h2>Post details:</h2>\n\n      <section className=\"PostDetails__post\">\n        <p>{post?.title}</p>\n      </section>\n\n      <section\n        className=\"PostDetails__comments\"\n        data-cy=\"postDetails\"\n      >\n        {postComments?.length ? (\n          <button\n            type=\"button\"\n            className=\"button\"\n            onClick={() => {\n              setShouldShowComments(!shouldShowComments);\n            }}\n          >\n            {shouldShowComments ? 'Hide' : 'Show'}\n            {' '}\n            {postComments?.length}\n            {' '}\n            comments\n          </button>\n        ) : (\n          <p>Add first comment</p>\n        )}\n\n        <ul className=\"PostDetails__list\">\n          {shouldShowComments && (\n            postComments?.map(comment => (\n              <li className=\"PostDetails__list-item\" key={comment.id}>\n                <button\n                  type=\"button\"\n                  className=\"PostDetails__remove-button button\"\n                  onClick={() => deleteComment(comment.id)}\n                >\n                  X\n                </button>\n                <p>{comment.body}</p>\n              </li>\n            ))\n          )}\n        </ul>\n      </section>\n\n      <section>\n        <div className=\"PostDetails__form-wrapper\">\n          <NewCommentForm\n            postId={post?.id || null}\n            fetchComments={fetchPostComments}\n          />\n        </div>\n      </section>\n    </div>\n  );\n};\n","import { BASE_URL } from './api';\n\nexport const getAllPosts = () => {\n  return fetch(`${BASE_URL}/posts`)\n    .then(response => response.json());\n};\n\nexport const getUserPosts = (userId: number) => {\n  return fetch(`${BASE_URL}/posts?userId=${userId}`)\n    .then(response => response.json());\n};\n\nexport const getPostDetails = (postId: number) => {\n  return fetch(`${BASE_URL}/posts/${postId}`)\n    .then(response => response.json());\n};\n","import React, { useEffect, useState } from 'react';\nimport './App.scss';\nimport './styles/general.scss';\nimport { PostsList } from './components/PostsList';\nimport { PostDetails } from './components/PostDetails';\nimport { getAllPosts, getUserPosts } from './api/posts';\nimport { Post, User } from './types';\nimport { getUsers } from './api/users';\n\nconst App: React.FC = () => {\n  const [postsList, setPostsList] = useState<Post[]>([]);\n  const [users, setUsers] = useState<User[]>([]);\n  const [visiblePosts, setVisiblePosts] = useState<Post[]>([]);\n  const [selectedPostId, setSelectedPostId] = useState(0);\n  const [selectedPost, setSelectedPost] = useState<Post>();\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      setPostsList(await getAllPosts());\n      setVisiblePosts(await getAllPosts());\n    };\n\n    const fetchUsers = async () => {\n      setUsers(await getUsers());\n    };\n\n    try {\n      fetchPosts();\n      fetchUsers();\n    } catch (error) {\n      throw new Error();\n    }\n  }, []);\n\n  useEffect(() => {\n    setSelectedPost(visiblePosts\n      .find(post => post.id === selectedPostId));\n  }, [selectedPostId]);\n\n  const onPostSelect = (postId: number) => {\n    if (postId !== selectedPostId) {\n      setSelectedPostId(postId);\n    } else {\n      setSelectedPostId(0);\n    }\n  };\n\n  const fetchUser = async (id: number) => {\n    if (id === 0) {\n      setVisiblePosts(postsList);\n\n      return;\n    }\n\n    setVisiblePosts(await getUserPosts(id));\n  };\n\n  return (\n    <div className=\"App\">\n      <header className=\"App__header\">\n        <label>\n          Select a user: &nbsp;\n\n          <select\n            className=\"App__user-selector\"\n            onChange={({ target }) => fetchUser(+target.value)}\n          >\n            <option value=\"0\">All users</option>\n            {users.map(user => (\n              <option value={user.id}>{user.name}</option>\n            ))}\n          </select>\n        </label>\n      </header>\n\n      <main className=\"App__main\">\n        <div className=\"App__sidebar\">\n          <PostsList\n            postsList={visiblePosts}\n            onPostSelect={onPostSelect}\n            selectedPost={selectedPost}\n          />\n        </div>\n        {selectedPost && (\n          <div className=\"App__content\">\n            <PostDetails post={selectedPost || null} />\n          </div>\n        )}\n      </main>\n    </div>\n  );\n};\n\nexport default App;\n","import { BASE_URL } from './api';\n\nexport const getUsers = () => {\n  return fetch(`${BASE_URL}/users`)\n    .then(response => response.json());\n};\n","import ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}